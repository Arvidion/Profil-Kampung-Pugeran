<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Galeri Foto - Kampung Pugeran</title>
    <meta name="description" content="Galeri foto lengkap Kampung Pugeran" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="icon" type="image/png" href="assets/images/PUGERAN.webp">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <style>
      .gallery-page-header {
        padding: 40px 0;
        text-align: center;
        border-bottom: 1px solid var(--border);
      }
      .gallery-page-header h1 {
        font-family: "Playfair Display", Georgia, serif;
        font-size: clamp(2rem, 4vw, 2.5rem);
        margin: 0 0 12px;
      }
      .gallery-page-header p {
        color: var(--muted);
        margin: 0;
      }
      .gallery-page-header .back-link {
        display: inline-block;
        margin-top: 20px;
        color: var(--primary);
        text-decoration: none;
        font-weight: 600;
      }
      .gallery-page-header .back-link:hover {
        text-decoration: underline;
      }
      .full-gallery-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
        padding: 40px 0;
      }
      .full-gallery-item {
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid var(--border);
        box-shadow: 0 10px 28px var(--shadow);
        position: relative;
        aspect-ratio: 4 / 3;
      }
      .full-gallery-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform .35s ease;
      }
      .full-gallery-item:hover img {
        transform: scale(1.05);
      }
      .loading {
        text-align: center;
        padding: 40px;
        color: var(--muted);
      }
    </style>
  </head>
  <body data-theme="light">
    <!-- Header / Navbar -->
    <header class="site-header">
      <div class="container header-inner">
        <a href="index.html#home" class="brand" aria-label="Kampung Pugeran">Kampung Pugeran</a>

        <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav" aria-label="Buka navigasi">
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </button>

        <nav id="site-nav" class="site-nav" aria-label="Navigasi utama">
          <ul>
            <li><a href="index.html#home">Beranda</a></li>
            <li><a href="index.html#tentang">Tentang</a></li>
            <li><a href="index.html#galeri">Galeri</a></li>
          </ul>
        </nav>
        <button class="theme-toggle" type="button" aria-pressed="false" aria-label="Aktifkan mode malam"></button>
      </div>
    </header>

    <main id="main-content">
      <div class="gallery-page-header">
        <div class="container">
          <h1>Galeri Foto</h1>
          <p>Kumpulan foto lengkap Kampung Pugeran</p>
          <a href="index.html#galeri" class="back-link">← Kembali ke Beranda</a>
        </div>
      </div>

      <div class="container">
        <div id="gallery-container" class="full-gallery-grid">
          <div class="loading">Memuat foto...</div>
        </div>
      </div>
    </main>

    <footer id="kontak" class="site-footer" aria-labelledby="heading-kontak">
      <div class="container footer-inner">
        <div class="footer-brand">
          <h3 id="heading-kontak">Kampung Pugeran</h3>
          <p>Kampung Pugeran, Suryodiningratan, Mantrijeron, Yogyakarta, </p>
          <p>Daerah Istimewa Yogyakarta, 55131.</p>
        </div>
      </div>
      <div class="copyright">
        <div class="container">
          <p>© <span id="year"></span> KKN AB.83.334.</p><p>Universitas Pembangunan Nasional "Veteran" Yogyakarta.</p>
        </div>
      </div>
    </footer>

    <div class="lightbox" id="lightbox" aria-hidden="true" role="dialog" aria-label="Pratinjau gambar">
      <button class="lightbox-close" aria-label="Tutup pratinjau">×</button>
      <button class="lightbox-nav prev" aria-label="Foto sebelumnya">❮</button>
      <img class="lightbox-image" alt="Gambar galeri" />
      <button class="lightbox-nav next" aria-label="Foto berikutnya">❯</button>
    </div>

    <script src="assets/js/main.js"></script>
    <script>
      // Auto-load all images from assets/images folder
      (function() {
        const $ = (sel, ctx = document) => ctx.querySelector(sel);
        const $$ = (sel, ctx = document) => Array.from(ctx.querySelectorAll(sel));

        const galleryContainer = $('#gallery-container');
        if (!galleryContainer) return;

        // List of all images in assets/images folder
        // This will automatically load all images
        const allImages = [
          'balai.webp',
          'bangunan1.webp',
          'bangungan2.webp',
          'DSCF1936.JPG',
          'poktan1.webp',
          'poktan2.webp',
          'poktan3.webp',
          'suasana1.webp',
          'suasana2.webp',
          'suasana3.webp'
        ];
        
        // Get all images
        async function getAllImageFiles() {
          const imageBasePath = 'assets/images/';
          const foundImages = [];
          
          // Check each image
          for (const imageName of allImages) {
            const imagePath = imageBasePath + imageName;
            const exists = await checkImageExists(imagePath);
            if (exists) {
              foundImages.push({
                src: imagePath,
                alt: imageName.replace(/\.[^/.]+$/, '').replace(/[_-]/g, ' ').trim() || 'Foto kampung'
              });
            }
          }
          
          return foundImages;
        }

        // Function to check if image exists
        function checkImageExists(src) {
          return new Promise((resolve) => {
            const img = new Image();
            img.onload = () => resolve(true);
            img.onerror = () => resolve(false);
            img.src = src;
          });
        }

        // Function to load all images
        async function loadAllImages() {
          // Get all images automatically
          const loadedImages = await getAllImageFiles();

          // Display images
          if (loadedImages.length > 0) {
            galleryContainer.innerHTML = '';
            loadedImages.forEach((image, index) => {
              const item = document.createElement('a');
              item.href = image.src;
              item.className = 'full-gallery-item reveal';
              item.setAttribute('data-reveal', '');
              
              const img = document.createElement('img');
              img.src = image.src;
              img.alt = image.alt;
              img.loading = 'lazy';
              
              item.appendChild(img);
              galleryContainer.appendChild(item);
            });

            // Initialize reveal animations
            const revealEls = $$('[data-reveal]');
            const io = new IntersectionObserver((entries) => {
              entries.forEach(entry => {
                if (entry.isIntersecting) {
                  entry.target.classList.add('is-visible');
                  io.unobserve(entry.target);
                }
              });
            }, { rootMargin: '0px 0px -10% 0px', threshold: 0.1 });
            revealEls.forEach(el => io.observe(el));

            // Setup lightbox for gallery items
            const galleryItems = $$('.full-gallery-item');
            const lightbox = $('#lightbox');
            const lightboxImg = $('.lightbox-image', lightbox);
            const lightboxClose = $('.lightbox-close', lightbox);
            const lightboxPrev = $('.lightbox-nav.prev', lightbox);
            const lightboxNext = $('.lightbox-nav.next', lightbox);
            let currentIndex = -1;

            const openLightbox = (src, alt, index = -1) => {
              if (!lightbox || !lightboxImg) return;
              lightboxImg.src = src;
              lightboxImg.alt = alt || 'Gambar galeri';
              lightbox.setAttribute('aria-hidden', 'false');
              lightbox.classList.add('open');
              document.body.style.overflow = 'hidden';
              currentIndex = index;
            };

            const closeLightbox = () => {
              if (!lightbox || !lightboxImg) return;
              lightbox.setAttribute('aria-hidden', 'true');
              lightbox.classList.remove('open');
              lightboxImg.src = '';
              document.body.style.overflow = '';
              currentIndex = -1;
            };

            galleryItems.forEach((item, index) => {
              item.addEventListener('click', (e) => {
                e.preventDefault();
                const img = item.querySelector('img');
                const src = item.getAttribute('href') || img?.src;
                const alt = img?.alt || 'Gambar galeri';
                if (src) openLightbox(src, alt, index);
              });
            });

            lightboxClose?.addEventListener('click', closeLightbox);
            lightbox?.addEventListener('click', (e) => {
              if (e.target === lightbox) closeLightbox();
            });

            function navigate(step) {
              if (!Array.isArray(galleryItems) || galleryItems.length === 0) return;
              if (currentIndex < 0) return;
              currentIndex = (currentIndex + step + galleryItems.length) % galleryItems.length;
              const item = galleryItems[currentIndex];
              const img = item.querySelector('img');
              const src = item.getAttribute('href') || img?.src;
              const alt = img?.alt || 'Gambar galeri';
              if (src) {
                lightboxImg.src = src;
                lightboxImg.alt = alt;
              }
            }

            document.addEventListener('keydown', (e) => {
              if (e.key === 'Escape') closeLightbox();
              if (lightbox?.classList.contains('open')) {
                if (e.key === 'ArrowRight') navigate(1);
                if (e.key === 'ArrowLeft') navigate(-1);
              }
            });

            lightboxNext?.addEventListener('click', () => navigate(1));
            lightboxPrev?.addEventListener('click', () => navigate(-1));
          } else {
            galleryContainer.innerHTML = '<div class="loading">Tidak ada foto yang ditemukan.</div>';
          }
        }

        // Load images when page is ready
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', loadAllImages);
        } else {
          loadAllImages();
        }

        // Footer year
        const yearEl = $('#year');
        if (yearEl) yearEl.textContent = String(new Date().getFullYear());
      })();
    </script>
  </body>
</html>

